{% extends 'template.html' %}
{% set active_page = 'reserve' %}

{% block external_css %}
    <link href="{{ url_for('static', filename='css/form.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/step_bar.css') }}" rel="stylesheet">
{% endblock %}

{% block body %}
    <!--progress-bar-->
    <div class="row">
        <div class="col-lg-12">
            <div class="row multistep current">
                <div class="col-lg-4 multistep-step complete">
                    <div class="text-center multistep-stepname"><strong>Step 1: Location</strong></div>
                    <div class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <a href="" class="multistep-dot"></a>
                </div>

                <div class="col-lg-4 multistep-step complete">
                    <div class="text-center multistep-stepname"><strong>Ste 2: Booking</strong></div>
                    <div class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <a href="" class="multistep-dot"></a>
                </div>

                <div class="col-lg-4 multistep-step compete">
                    <div class="text-center multistep-stepname"><strong>Step 3: Payment</strong></div>
                    <div class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <a href="" class="multistep-dot"></a>
                </div>
                <br><br>
                <hr>
                <br>
            </div>
        </div>
    </div>
    <!--/progress-bar-->

    <!--payment side-->
    <div class="col-lg-6">
        <!--demo display-->
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <svg class="glyph stroked film">
                        <use xlink:href="#stroked-film"/>
                    </svg>
                    Demo Display
                </h3>
            </div>
            <div class="panel-body text-center">
                <video id="player" preload="auto" width="600" height="400" autoplay>
                    <source id="mp4Source" src="">
                </video>

                <br>
                <hr>
                <br>
            </div>
        </div>
        <!--/demo display-->

        <!--price panel-->
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <svg class="glyph stroked round coffee mug">
                        <use xlink:href="#stroked-round-coffee-mug"/>
                    </svg>
                    Discount Offering
                </h3>
            </div>
            <div class="panel-body">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>Description</th>
                        <th class="text-center"></th>
                        <th></th>
                        <th class="text-center">Discount</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="col-md-9 "><em>Offer discount for panel usage</em>
                        </td>
                        <td class="col-md-8 text-right">Number of booking of this panel: </td>
                        <td></td>
                        <td class="col-md-1 text-center">{{ session['discount_on_panel_usage'] }}%</td>
                    </tr>
                    <tr>
                        <td class="col-md-9"><em>Offer 90% for booking history</em>
                        </td>
                        <td class="col-md-8 text-right">Number of booking you have made: </td>
                        <td></td>
                        <td class="col-md-1 text-center">no discount</td>
                    </tr>
                    <tr>
                        <td class="col-md-9"><em>Offer 90% if booking period is 3 mths or more</em>
                        </td>
                        <td class="col-md-8 text-right">Your Booking Period: </td>
                        <td></td>
                        <td class="col-md-1 text-center">90%</td>
                    </tr>
                    <tr>
                        <td>  </td>
                        <td class="text-right">
                            <h4><strong>Total: </strong></h4></td>
                        <td></td>
                        <td class="text-center text-danger">
                            <h4><strong>270,000</strong></h4></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!--/price panel-->

        <!--payment panel-->
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <img class="pull-right" src="http://i76.imgup.net/accepted_c22e0.png">
                    <svg class="glyph stroked key ">
                        <use xlink:href="#stroked-key"/>
                    </svg>
                    Payment Panel
                </h3>
            </div>
            <div class="panel-body">
                <form role="form" id="payment-form" action="confirm">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="form-group">
                                <label for="cardNumber">CARD NUMBER</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" name="cardNumber"
                                           placeholder="Valid Card Number" required autofocus
                                           data-stripe="number"/>
                                    <span class="input-group-addon"><i class="fa fa-credit-card"></i></span>
                                </div>
                                <br>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-7 col-md-7">
                            <div class="form-group">
                                <div class="col-xs-12 col-lg-12 pl-ziro">
                                    <label for="expMonth">EXPIRATION DATE</label>
                                </div>
                                <div class="col-xs-6 col-lg-6 pl-ziro">
                                    <input type="text" class="form-control" name="expMonth" placeholder="MM"
                                           required data-stripe="exp_month"/>
                                </div>
                                <div class="col-xs-6 col-lg-6 pl-ziro">
                                    <input type="text" class="form-control" name="expYear" placeholder="YY"
                                           required
                                           data-stripe="exp_year"/>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-5 col-md-5 pull-right">
                            <div class="form-group">
                                <label for="cvCode">CV CODE</label>
                                <input type="password" class="form-control" name="cvCode" placeholder="CV"
                                       required
                                       data-stripe="cvc"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="form-group">
                                <br>
                                <label for="couponCode">COUPON CODE</label>
                                <input type="text" class="form-control" name="couponCode"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <br><br>
                            <button class="btn btn-success btn-lg btn-block" type="submit">Submit Payment
                            </button>
                        </div>
                    </div>
                    <div class="row" style="display:none;">
                        <div class="col-xs-12">
                            <p class="payment-errors"></p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!--/payment panel -->
    </div>
    <!--/payment side-->

    <!--detail side-->
    {% for item in panel_list_by_pid %}
        <div class="col-lg-6">
        <div class="panel panel-info">
        <div class="panel-heading">
            <svg class="glyph stroked clipboard with paper">
                <use xlink:href="#stroked-clipboard-with-paper"/>
            </svg>
            Booking Details
        </div>

        <div class="panel-body">
        <!--img-->
        <div class="row">
            <img class="center-block" src="{{ url_for('static', filename='img/' + item.panel_path) }}"
                 height="200"
                 width="300">
            <hr>
        </div>
        <!--/img-->

        <!--panel details-->
        <div class="row">
            <div class="table-responsive">
                <h4>&emsp;Panel Details</h4>
                <table class="table table-striped">
                    <tr>
                        <td style="font-weight:bold;">Name</td>
                        <td>{{ item.name }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Region</td>
                        <td>{{ item.region }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Location</td>
                        <td>{{ item.location }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Height</td>
                        <td>{{ item.height }} m</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Width</td>
                        <td>{{ item.width }} m</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Opening Hours</td>
                        <td>08:00 - 22:00 &emsp;&emsp;&emsp; Mon - Sun</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Airtime Rate (mthly)</td>
                        <td>HKD {{ item.airtime_rate }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Pedestrain Flow (daily)</td>
                        <td>{{ item.pedestrain_flow }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Business Mode</td>
                        <td>{{ item.mode }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Capacity</td>
                        <td>{{ item.cap }}</td>
                    </tr>
                    <tr>
                        <td style="font-weight:bold">Number of Booking</td>
                        <td>{{ item.used }}</td>
                    </tr>
                </table>
                <br>
                {% for image in panel_all_image %}
                    <img src="{{ url_for('static', filename='img/' + image.panel_path) }}" height="150"
                         width="250">
                {% endfor %}
            </div>
        </div>
    {% endfor %}
<!--panel details-->

<!--booking detail-->
<div class="row">
    <hr>
    <br>
    <div class="table-responsive">
        <h4>&emsp;Booking Details</h4>
        <table class="table table-striped">
            <tr>
                <td style="font-weight:bold">Date From</td>
                <td>{{ session['date_from'] }}</td>
            </tr>
            <tr>
                <td style="font-weight: bold">Date To</td>
                <td>{{ session['date_to'] }}</td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Type</td>
                <td>{{ session['file_type'] }}</td>
            </tr>
        </table>
        <hr>
    </div>
</div>
<!--/booking detail-->
</div>
</div>
</div>
    <!--/detail side-->
{% endblock %}

{% block external_js %}
    <script>
        video_url = [];

        $(document).ready(function () {
            $.ajax({
                method: 'post',
                url: '/simulation',
                dataType: 'json',
                success: function (result) {
                    $.each(result, function (key, val) {
                        if (key == 0) {
                            $("#mp4Source").attr("src", "{{ url_for('static', filename='file_source/') }}" + val);
                            player.load();
                            player.play();
                        }

                        video_url.push(val);
                    });
                }
            });
        });

        var count = 1;
        $("#player").on("ended", function () {
            if (count == video_url.length)
                count = 0;

            $("#mp4Source").attr("src", "{{ url_for('static', filename='file_source/') }}" + video_url[count++]);
            player.load();
            player.play();
        });
    </script>
{% endblock %}


